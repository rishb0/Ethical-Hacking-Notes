
## 📌 Part 1: **How to Mount OneDrive Locally on Linux using `rclone`**

### ✅ 1. **Install `rclone`**

- Make sure `rclone` is installed on your system.
    

```bash
sudo apt install rclone
```

---

### ✅ 2. **Configure OneDrive with `rclone config`**

- Start configuration:
    

```bash
rclone config
```

- Follow the steps:
    
    - Choose `n` to create a new remote.
        
    - Name it (e.g., `onedrive`).
        
    - Choose **`24`** for OneDrive.
        
    - Keep default `client_id` and `client_secret` blank (or enter if you have them).
        
    - Select `Microsoft account` when asked.
        
    - Open the auth URL in browser and complete login.
        
    - After successful auth, `rclone` will save the config.
        

---

### ✅ 3. **Create Mount Directory**

- Example:
    

```bash
sudo mkdir -p /mnt/OneDrive
```

- Give your user ownership if not using `sudo` every time:
    

```bash
sudo chown $USER:$USER /mnt/OneDrive
```

---

### ✅ 4. **Test the Mount Manually**

```bash
rclone mount onedrive: /mnt/OneDrive --vfs-cache-mode writes
```

- Press Ctrl+C to stop after testing.
    

---

### ✅ 5. **Auto Mount with systemd Service**

#### 🛠️ Step 1: Create systemd service file

```bash
sudo nano /etc/systemd/system/onedrive.service
```

#### 🧾 Paste the following content:

```ini
[Unit]
Description=Mount OneDrive via rclone
AssertPathIsDirectory=/mnt/OneDrive
After=network-online.target
Wants=network-online.target

[Service]
Type=simple
ExecStart=/usr/bin/rclone mount onedrive: /mnt/OneDrive --vfs-cache-mode writes
ExecStop=/bin/fusermount -u /mnt/OneDrive
Restart=always
RestartSec=10

[Install]
WantedBy=default.target
```

#### 🔐 Make sure rclone config is under root if you run with sudo:

```bash
sudo rclone config
```

Or copy your user config to root:

```bash
sudo mkdir -p /root/.config/rclone
sudo cp ~/.config/rclone/rclone.conf /root/.config/rclone/
```

---

#### ✅ Enable and Start the Service:

```bash
sudo systemctl daemon-reexec
sudo systemctl daemon-reload
sudo systemctl enable --now onedrive.service
```

---

### ✅ 6. **Verify Mount**

```bash
systemctl status onedrive.service
ls /mnt/OneDrive
```

---

## ❌ Part 2: **How to Unmount and Remove Everything**

---

### 🧹 A. **Stop and Disable the Service**

```bash
sudo systemctl stop onedrive.service
sudo systemctl disable onedrive.service
```

---

### 🗑️ B. **Delete systemd Service File**

```bash
sudo rm /etc/systemd/system/onedrive.service
```

Reload:

```bash
sudo systemctl daemon-reexec
sudo systemctl daemon-reload
```

---

### 🔌 C. **Unmount if still mounted**

```bash
sudo fusermount -u /mnt/OneDrive
```

If error like _Transport endpoint is not connected_, use:

```bash
sudo umount -l /mnt/OneDrive
```

---

### 📂 D. **Delete Mount Directory**

```bash
sudo rm -r /mnt/OneDrive
```

---

### 📄 E. **Delete rclone Config**

For root:

```bash
sudo rm /root/.config/rclone/rclone.conf
```

For your user:

```bash
rm ~/.config/rclone/rclone.conf
```

---
---
