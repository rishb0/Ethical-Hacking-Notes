# NVIDIA-Driver-on-Optimus-Laptop(Kali-Linux)
## Installing Official NVIDIA Driver on Optimus Laptop (Kali Linux)
***
### 1. Check System Info
```bash
uname -a
```

```bash
lspci | grep -E "VGA|3D"
```

*   Confirm that you have **hybrid graphics** (Intel + NVIDIA).

### 2. Disable Nouveau (Open Source NVIDIA Driver)
```bash
echo -e "blacklist nouveau\noptions nouveau modeset=0\nalias nouveau off" > /etc/modprobe.d/blacklist-nouveau.conf
```

```bash
cat /etc/modprobe.d/blacklist-nouveau.conf
```

```bash
update-initramfs -u && reboot
```

After reboot, verify that Nouveau is disabled:

```bash
lsmod | grep -i nouveau
```
*   If the command returns nothing, Nouveau is disabled.

### 3. Install NVIDIA Driver
```bash
apt install nvidia-driver nvidia-xconfig
```

### 4. Find NVIDIA BusID
```bash
nvidia-xconfig --query-gpu-info | grep 'BusID : ' | cut -d ' ' -f6
```
Example output:
```
PCI:1:0:0
```

### 5. Configure Xorg
***
Edit `/etc/X11/xorg.conf`:
```bash
vim /etc/X11/xorg.conf
```
Paste the following:
```
Section "ServerLayout"
    Identifier "layout"
    Screen 0 "nvidia"
    Inactive "intel"
EndSection

Section "Device"
    Identifier "nvidia"
    Driver "nvidia"
    BusID "PCI:1:0:0"
EndSection

Section "Screen"
    Identifier "nvidia"
    Device "nvidia"
    Option "AllowEmptyInitialConfiguration"
EndSection

Section "Device"
    Identifier "intel"
    Driver "modesetting"
EndSection

Section "Screen"
    Identifier "intel"
    Device "intel"
EndSection
```
> ⚡️ Make sure to replace `BusID` with your actual value if different.

### 6. Configure Display Manager Startup (GDM)
***
Create a new autostart entry:
```bash
vim /usr/share/gdm/greeter/autostart/optimus.desktop
```
Paste the following:
```ini
[Desktop Entry]
Type=Application
Name=Optimus
Exec=sh -c "xrandr --setprovideroutputsource modesetting NVIDIA-0; xrandr --auto"
NoDisplay=true
X-GNOME-Autostart-Phase=DisplayServer
```
Then copy it:
```bash
cp -v /usr/share/gdm/greeter/autostart/optimus.desktop /etc/xdg/autostart/optimus.desktop
```

### 7. Reboot and Verify
***
Reboot your machine, then verify:
```bash
glxinfo | grep -i "direct rendering"
```
*   If output is `direct rendering: Yes`, everything works

---
---
