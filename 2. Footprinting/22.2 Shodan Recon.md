# Shodan Recon
***
Shodan is a search engine for internet-connected devices. It's widely used in cybersecurity for reconnaissance, identifying exposed systems, services, and potential vulnerabilities.

*   **Website:** [https://www.shodan.io/](https://www.shodan.io/)
*   **Filter Reference:** [https://www.shodan.io/search/filters](https://www.shodan.io/search/filters)

## How Shodan Works
***
### 1. Global Internet Scanning
Shodan uses a large network of scanners to connect to every public IPv4 address and tries to interact with open ports. It behaves like a **banner grabber**.

For example:
*   It connects to `x.x.x.x:80` and records the HTTP response header.
*   It connects to `x.x.x.x:21` and records the FTP banner.

### 2. Banner Collection
When Shodan connects to a device or service, it retrieves the **service banner** or metadata that the service exposes. This may include:

*   Software name and version (e.g., Apache 2.4.7)
*   OS type and version
*   SSL certificate details
*   Web server headers
*   Authentication methods
*   Error messages
*   Custom titles or messages

### 3. Indexing and Tagging
Collected data is:
*   Indexed in a search database
*   Tagged by:
    *   Port (`port:80`)
    *   Protocol (`product:"Apache"`)
    *   Organization (`org:"Google"`)
    *   Location (`country:US`)
    *   Vulnerabilities (using banner signature + known CVEs)
    *   SSL certificate fields
    *   Web technologies (`http.component:"WordPress"`)

### 4. Vulnerability Matching
Shodan cross-references collected banners with known CVEs from:

*   [National Vulnerability Database (NVD)](https://nvd.nist.gov/)
*   Internal vulnerability signature sets

If a match is found, the system flags the service with the corresponding `vuln:CVE-XXXX-XXXX` tag.

### 5. User Interface + API
You can access all this information via:

*   [Web UI](https://www.shodan.io/)
*   Shodan CLI
*   [Shodan API](https://developer.shodan.io/)
    *   Allows automation and integrations
    *   Common in red team tools and threat intelligence

### âœ… Example of Data for an IP on Port 80:

```json
 {
    "ip_str": "192.0.2.123",
    "port": 80,
    "org": "Example ISP",
    "location": {
        "country_name": "India",
        "city": "Delhi"
    },
    "http": {
        "title": "Apache2 Ubuntu Default Page",
        "server": "Apache/2.4.18 (Ubuntu)"
    },
    "os": "Linux",
    "vulns": ["CVE-2017-5638"]
 }
```

| Stage       | Description                                               |
| ----------- | --------------------------------------------------------- |
| Scanning    | Shodan probes IPs and ports like a port scanner           |
| Banner Grab | It collects response data from open services              |
| Parsing     | Banners are parsed for product, version, os, etc.         |
| Indexing    | Data is indexed and tagged with location, org, technology |
| CVE Mapping | Services are matched against known vulnerabilities        |
| Access      | Users can search via UI, CLI, or API                      |

------
## Account Setup
***
1.  Register on [Shodan](https://www.shodan.io/).
2.  Visit your profile to obtain your **API Key**.

## Basic Search Usage
***
```
1 apache
2 ftp
3 wordpress
4 nginx
5 cisco ios
```
Use filters to narrow results:
```
1 apache port:80 country:US
```

----
##  Filters Reference
***
**port:** - Search by Open Port
```
1 port:80
2 port:443
3 port:22
4 port:21
```
Examples:
```
1 port:80 Apache
2 device:webcam port:554
```
**product:** - Search by Product
```
product:"apache"
product:"apache tomcat"
3 product:"Remote Desktop Protocol"
4 product:"LiteSpeed httpd"
```
Combined:
```
1 port:8080 product:"Apache Tomcat"
```
**http.component:** - Web Technologies
```
1 http.component:"wordpress"
2 http.component:"PHP"
3 http.component:"MySQL"
4 http.component:"Yoast SEO"
```
With version or status:
```
1 http.component:"wordpress" http.status:200
2 http.component:"wordpress" version:"6.4.2"
```
**asn:** - Filter by ASN
```
1 asn:AS24560
```
Useful sites:
*   [https://asnlookup.com](https://asnlookup.com)
*   [https://hackertarget.com/as-ip-lookup](https://hackertarget.com/as-ip-lookup)

	