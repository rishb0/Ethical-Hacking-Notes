# hping3

`hping3` is an advanced, versatile command-line network tool for crafting and sending custom TCP/IP packets. It is widely used for security testing, network diagnostics, firewall testing, port scanning, and traceroute-like operations. Unlike traditional ping tools that only send ICMP echo requests, `hping3` can send TCP, UDP, ICMP, and RAW IP packets with precise control over flags, payloads, and packet parameters.

---

## Key points about hping3:

*   Supports crafting TCP, UDP, ICMP, and RAW IP packets.
*   Allows setting custom flags on TCP packets (SYN, ACK, FIN, RST, URG, PSH, Xmas).
*   Can perform TCP/IP stack auditing, firewall testing, and advanced network scanning.
*   Supports port scanning with customizable port ranges and flags.
*   Can spoof source IP addresses and ports for testing.
*   Useful for network troubleshooting, firewall rule testing, and security research.
*   Includes features for traceroute, packet flooding, and network stress testing.
*   Requires root or administrative privileges to send raw packets.

---

## Common hping3 Usage and Flags Description:

Display help or usage:
```
hping3 -h
```

```
hping3 --help
```

Show verbose output:
```
hping3 -v
```

Send RAW IP packets to a target:
```
hping3 -0 192.168.1.51
```

```
hping3 --rawip 192.168.1.51
```

Send a specific number of packets (here 2) to a host:
```
hping3 -c 2 192.168.1.31
```

ICMP mode (like ping but with hping3's control):
```
hping3 -1 192.168.1.51
```

```
hping3 --icmp 192.168.1.51
```

```
hping3 --icmp -c 2 192.168.1.51
```

UDP mode:
```
hping3 -2 192.168.1.51
```

```
hping3 --udp 192.168.1.51
```

TCP port scanning mode (scanning port ranges):
```
hping3 -8 80-1000 192.168.1.51
```

```
hping3 --scan 80-1000 192.168.1.51
```

Scan multiple ports with verbose output, setting SYN flag (-S):
```
hping3 --scan 1-30,70-90 -S 192.168.1.51
```

```
hping3 --scan 1-30,70-90 -S www.armourinfosec.com
```

Scan specific ports with flags: FIN flag on ports 80 & 443
```
hping3 -8 80,443 -F 192.168.1.51
```

```
hping3 --scan 80,444 -S 192.168.1.51
```

Spoof source IP address:
```
hping3 -a 192.168.1.15 192.168.1.51
```

Set specific ICMP code (force ICMP code):
```
hping3 -K --force-icmp 192.168.1.51
```

Trace route with hping3:
```
hping3 -T 8.8.8.8
```

---
## hping3 TCP Flags:

`hping3` is a tool that allows you to craft TCP packets with specific control flags set, giving you fine-grained power to test host and firewall behaviors, probe ports, and analyze network stack responses.

## TCP Flag Descriptions

| Flag | Description                                                           | Typical Use Case                                    |
| :--- | :-------------------------------------------------------------------- | :-------------------------------------------------- |
| URG  | Urgent pointer is significant; signals urgent data in the TCP stream. | Rarely seen in scanning; tests firewall and stack.  |
| FIN  | Finish flag; requests a graceful close of a TCP connection.           | Used in stealth FIN scans for port state discovery. |
| SYN  | Synchronize; initiates a TCP connection.                              | Key for SYN scans—quickly finds listening ports.    |
| RST  | Reset; abrupt termination of TCP connection.                          | Closes connections or tests firewall blocking.      |
| PSH  | Push; asks receiver to pass data to the application immediately.      | Used for protocol or stack behavior tests.          |
| ACK  | Acknowledgment; confirms receipt of data.                             | Traces firewall rules or for advanced scans.        |
| XMAS | Combo of FIN, PSH, and URG set ("Christmas Tree" packet).             | Used in stealth scans to see how endpoints respond. |

---

## Example hping3 Commands

Set URG flag only: Sends a TCP packet with the URG flag set, checking how target/firewall handles urgent data.
```
hping3 -U 192.168.1.51
```

UDP mode with URG flag (unusual/experimental): Sends UDP packets (-2 ), tries to set URG flag. Since UDP has no urgency, mainly for experimental/advanced testing.
```
hping3 -2 -U 192.168.1.51
```

Set FIN flag: Stealth FIN scan to identify port states based on how targets respond.
```
hping3 -F 192.168.1.51
```

Set SYN flag: SYN scan to probe open TCP ports without completing handshake.
```
hping3 -S 192.168.1.51
```

Set RST flag: Sends TCP reset, which can be used to force connections closed or see how firewall deals with RST packets.
```
hping3 -R 192.168.1.51
```

Set PSH flag: Sets the TCP PUSH flag for protocol or firewall behavior testing.
```
hping3 -P 192.168.1.51
```

Set ACK flag: Probes how the system/firewall handles packets with ACK. Used in some mapping and advanced scan techniques.
```
hping3 -A 192.168.1.51
```

Set XMAS flag (FIN, PSH, URG): Sends a "Christmas tree" packet—combines FIN, PSH, and URG, often used for stealthy port scanning.
```
hping3 -X 192.168.1.51
```

---

These commands enable advanced probing, penetration testing, and firewall auditing beyond simple ICMP ping tests. Each flag manipulates the TCP packet in a way that can reveal specifics about network defenses and service configurations.

## Additional Notes:

*   `hping3` requires root privileges to send crafted packets.
*   Flags often represent different TCP control bits, useful in stealth scans and firewall evasion techniques.
*   The scanning mode (`-8` or `--scan`) allows targeting port ranges or specific ports with various flags to gauge port states.
*   RAW IP mode (`-0` or `--rawip`) permits sending custom IP packets without protocol overhead, useful for advanced packet experiments.
---
---
