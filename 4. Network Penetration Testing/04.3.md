# arping

`arping` is a network utility used to discover and probe hosts on a local network by sending Address Resolution Protocol (ARP) requests at the data link layer (OSI Layer 2). Unlike the traditional ping command, which uses ICMP at the network layer (OSI Layer 3), arping sends ARP requests directly to a host identified by its IP or MAC address and waits for ARP replies.

---

## Key points about arping:

*   It operates at a lower level than ping, using ARP to resolve a device's MAC address from its IP address on the local network.
*   It can be used to check if a host is reachable on a local network by sending ARP requests to its IP.
*   The tool shows the MAC address of the responding device along with the round-trip time for the ARP request and reply.
*   Normally, arping starts out by sending broadcast ARP requests; once it receives a reply, it switches to unicast.
*   It requires root privileges to run on Linux systems.
*   It only works on local networks due to the nature of ARP (not routable beyond the local subnet).
*   Common options include specifying the count of ARP requests (-c), setting the network interface (-I), or using unsolicited ARP to update neighbors' cache (-U).
*   There are different implementations, such as the one in Linux iputils and another by Thomas Habets, which adds more features including pinging by MAC address.

### Additional useful options:
*   `-f`: Stop sending requests as soon as the first reply is received.
*   `-w <seconds>`: Set a timeout duration, to stop after specified time.
*   `-q`: Quiet mode, suppress output.
*   `-v`: Verbose mode for detailed output.
*   `-b`: Send only MAC broadcasts (no unicast).
*   `-D`: Duplicate address detection mode.

---

## Example usage:

This sends ARP requests to the IP 192.168.1.17 and returns replies with the MAC address and response time.
```
arping 192.168.1.17
```

---

In summary, arping is especially useful for network administrators to verify that a device is reachable at the link layer and to discover the MAC addresses of devices on a local network segment. It complements the ping command, which operates at the IP layer and may not always receive replies if devices are behind firewalls or different subnets.

## Common arping Commands:

Basic command without arguments: Displays help or waits for an IP to send ARP requests to. Without an IP or options, it generally won't send requests.
```
arping
```

Send ARP requests to a host: Sends ARP requests continuously to the IP address 192.168.1.11 until stopped manually. Helps check if the device is responding to ARP.
```
arping 192.168.1.11
```

Send a single ARP request: Sends exactly one ARP request and then stops, useful for quick checks or scripting.
```
arping -c 1 192.168.1.11
```

Specify source MAC address: Sets the source MAC address to `98:28:a6:04:19:2c` for outgoing ARP requests (useful for advanced testing or spoofing).
```
arping -s 98:28:a6:04:19:2c 192.168.1.11
```

Send one ARP request with a specified source MAC to another IP: Combines single ARP request with custom source MAC address for IP 192.168.1.51.
```
arping -c 1 -s 98:28:a6:04:19:2c 192.168.1.51
```

Send two ARP requests on a specific interface with custom source MAC: Sends two requests from interface `eth0` with source MAC `98:28:a6:04:19:2c` to 192.168.1.25.
```
arping -c 2 -s 98:28:a6:04:19:2c 192.168.1.25 -I eth0
```

Send 10 ARP requests with specified interface and source MAC: Sends 10 ARP requests from interface `eth0` with source MAC `08:00:27:fb:70:0e` to 192.168.1.31.
```
arping -s 08:00:27:fb:70:0e -c 10 192.168.1.31 -I eth0
```

---

## Example Script to Scan a Subnet Using arping:

```bash
for i in {1..254}; do arping -c 1 192.168.1.$i; done
```
*   Loops through all IP addresses in the `192.168.1.0/24` subnet.
*   Sends one ARP request each to test if hosts are alive.
## Combined Ping and Arping Scan Script

```bash
#!/bin/bash

# Scan the subnet 192.168.1.0/24 with both ICMP ping and ARP requests
for i in {1..254}
do
    IP="192.168.1.$i"

    # Ping the IP once with one second wait
    ping -c 1 -W 1 $IP > /dev/null
    if [ $? -eq 0 ]; then
        echo "Ping: $IP is online"
    fi

    # Send one ARP request and wait one second for reply
    arping -c 1 -w 1 $IP > /dev/null
    if [ $? -eq 0 ]; then
        echo "Arping: $IP is online"
    fi
done
```
*   Checks each IP with both ping (ICMP) and arping (ARP).
*   Helps discover devices even if ICMP is disabled but ARP is available.

---
